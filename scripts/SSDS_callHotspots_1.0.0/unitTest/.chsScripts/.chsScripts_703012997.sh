#!/bin/bash
sort -k1,1 -k2n,2n -k3n,3n -k4,4 -k5,5 -k6,6 -T /tmp/ /home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0/unitTest/dmc1SSDS_CHSdemo.chstestgenome.ssDNA_type1.bed |uniq >/tmp/dmc1SSDS_CHSdemo.chstestgenome.ssDNA_type1.uniq.bed
sort -k1,1 -k2n,2n -k3n,3n -k4,4 -k5,5 -k6,6 -T /tmp/ /home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0/unitTest/IgG_SSDS_CHSdemo.chstestgenome.ssDNA_type1.bed |uniq >/tmp/IgG_SSDS_CHSdemo.chstestgenome.ssDNA_type1.uniq.bed
R --vanilla </tmp/SSDSpl_tmp_30089092494/CHS_NCIS_103232256275.R
ratio=`perl /home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0//getNCISratio.pl /home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0/unitTest/output/callHotspotsTest.NCISout`
python2.7 /home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0/macs_2.1.0.20150731/usr/local/bin//macs2 callpeak --ratio $ratio -g 30000000 -t /tmp/dmc1SSDS_CHSdemo.chstestgenome.ssDNA_type1.uniq.bed -c /tmp/IgG_SSDS_CHSdemo.chstestgenome.ssDNA_type1.uniq.bed --bw 1000 --keep-dup all --slocal 5000 --name /home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0/unitTest/output/callHotspotsTest >/home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0/unitTest/output/callHotspotsTest.macs2callpeak.190219_101251.OUT 2>/home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0/unitTest/output/callHotspotsTest.macs2callpeak.190219_101251.ERR
cut -f1-3 /home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0/unitTest/output/callHotspotsTest_peaks.narrowPeak |grep -v ^M |grep -v chrM |sort -k1,1 -k2n,2n >/home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0/unitTest/output/callHotspotsTest_peaks.bed
perl /home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0//calcStrengthAndRecenterHotspots.pl --hs /home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0/unitTest/output/callHotspotsTest_peaks.bed --frag /home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0/unitTest/dmc1SSDS_CHSdemo.chstestgenome.ssDNA_type1.bed --v --out /home/kailey/callHotSpots-project/scripts/SSDS_callHotspots_1.0.0/unitTest/output/callHotspotsTest_peaks.bedgraph 
